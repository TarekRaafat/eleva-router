!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).ElevaRouter=e()}(this,(function(){"use strict";class t{constructor(t,e={}){if(this.eleva=t,this.container=e.container,!this.container)throw new Error("Router requires a container DOM element in options.");this.routes=e.routes||[],this.mode=e.mode||"hash",this.defaultRoute=e.defaultRoute||null}start(){if("hash"===this.mode)window.addEventListener("hashchange",(()=>this.routeChanged()));else{if("query"!==this.mode&&"history"!==this.mode)throw new Error(`Invalid routing mode: ${this.mode}`);window.addEventListener("popstate",(()=>this.routeChanged()))}this.routeChanged()}routeChanged(){let t,e,o;if("hash"===this.mode){o=window.location.href;let n=window.location.hash.slice(1)||"/";[t,e]=n.split("?"),t=t||"/"}else if("query"===this.mode){o=window.location.href;const n=window.location.search,i=new URLSearchParams(n);t=i.get("page")||"/",i.delete("page"),e=i.toString()}else{if("history"!==this.mode)throw new Error("Invalid router mode: "+this.mode);o=window.location.href,t=window.location.pathname||"/",e=window.location.search?window.location.search.slice(1):""}const n=this.parseQuery(e);let i=this.matchRoute(t);if(!i&&this.defaultRoute&&(i=this.defaultRoute),i){const e=this.wrapComponentWithRoute(i.component,{path:t,query:n,fullUrl:o}),s=i.props||{};this.eleva.mount(this.container,e,s)}}parseQuery(t){const e={};return t?(t.split("&").forEach((t=>{const[o,n]=t.split("=");o&&(e[decodeURIComponent(o)]=n?decodeURIComponent(n):"")})),e):e}matchRoute(t){return this.routes.find((e=>e.path===t))}navigate(t){if("hash"===this.mode)window.location.hash=t;else if("query"===this.mode){const e=new URLSearchParams(window.location.search);e.set("page",t);const o=window.location.pathname+"?"+e.toString();history.pushState({},"",o),this.routeChanged()}else"history"===this.mode&&(history.pushState({},"",t),this.routeChanged())}addRoute(t){this.routes.push(t)}wrapComponentWithRoute(t,e){let o=t;if("string"==typeof t&&(o=this.eleva._components[t],!o))throw new Error(`Component "${t}" not registered.`);const n={...o},i=n.setup;return n.setup=t=>{const o=i?i(t):{};return Object.assign({},o,{route:e,navigate:this.navigate.bind(this)})},n}}return{install(e,o={}){const n=o.routes||[];let i=0;n.forEach((t=>{if("object"==typeof t.component){let o=t.component.name;o||(o="AutoRegComponent_"+i++),e.component(o,t.component),t.component=o}}));const s=new t(e,o);e.router=s,s.start()}}}));
//# sourceMappingURL=eleva-router.min.js.map
